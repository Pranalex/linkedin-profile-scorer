# Security Configuration Guide

## ⚠️ Important Security Notice

**NEVER upload your actual n8n workflow JSON file to public repositories!** It contains sensitive credential references and unique identifiers that could compromise your system.

## 🛡️ Secure Workflow Import

### Step 1: Use the Template File
- Import `workflows/linkedin-profile-scorer-template.json` (sanitized version)
- Do NOT import your actual workflow file from local n8n exports

### Step 2: Replace Placeholders
After importing the template, update these placeholders:

#### Node IDs
- All `REPLACE_WITH_YOUR_ID` entries will be auto-generated by n8n
- No manual action needed

#### Webhook Configuration
- `REPLACE_WITH_YOUR_WEBHOOK_ID` → Auto-generated by n8n
- Note the webhook URL for API calls

#### Credential References
Update these with your actual credential IDs:

```json
// Google Gemini Node
"credentials": {
  "googleGeminiApi": {
    "id": "YOUR_GEMINI_CREDENTIAL_ID",
    "name": "Google Gemini API"
  }
}

// PostgreSQL Node  
"credentials": {
  "postgres": {
    "id": "YOUR_POSTGRES_CREDENTIAL_ID", 
    "name": "Postgres Database"
  }
}

// Notion Node
"credentials": {
  "notionApi": {
    "id": "YOUR_NOTION_CREDENTIAL_ID",
    "name": "Notion API"
  }
}
```

#### Database Configuration
- `YOUR_NOTION_DATABASE_ID` → Your Notion database ID
- Update PostgreSQL connection details

### Step 3: Implement Complete Code
The template contains simplified code. Copy the full implementations from:

1. **Score Code Node**: Use code from `scoring/linkedin_profile_scorer.js`
2. **Enhanced Score Code Node**: Use code from `scoring/enhanced_score_logic.js`
3. **PostgreSQL Query**: Use schema from `database/postgresql-schema.sql`

## 🔐 Credential Management

### Creating Secure Credentials in n8n

#### 1. Google Gemini API
```
Name: Google Gemini API
Type: Google Gemini API
API Key: [Your Gemini API Key]
```

#### 2. PostgreSQL Database
```
Name: Postgres Database  
Type: Postgres
Host: [Your DB Host]
Database: linkedin_profiles
User: linkedin_user
Password: [Your Secure Password]
```

#### 3. Notion API
```
Name: Notion API
Type: Notion API
API Key: [Your Notion Integration Token]
```

#### 4. Apify (if using)
```
Name: Apify API
Type: Apify API
API Token: [Your Apify Token]
```

## 🔒 Environment Security

### Database Security
- Use strong passwords (minimum 16 characters)
- Enable SSL connections
- Restrict network access to database
- Regular security updates

### API Key Security
- Rotate keys regularly (quarterly recommended)
- Use environment-specific keys (dev/prod)
- Monitor API usage for anomalies
- Implement rate limiting

### Network Security
- Use HTTPS for all webhook endpoints
- Implement IP whitelisting if possible
- Use reverse proxy with security headers
- Enable firewall rules

## 🚫 What NOT to Share

### Never Commit These to Git:
- Actual n8n workflow exports (.json files from your instance)
- Database connection strings with credentials
- API keys or tokens
- Webhook URLs with sensitive paths
- Environment files with secrets (.env)
- Backup files containing credentials

### Safe to Share:
- Template workflow files (sanitized)
- Database schema files (without credentials)
- Documentation and setup guides
- Code files (without hardcoded secrets)

## 🔄 Secure Development Workflow

### 1. Local Development
```bash
# Use environment variables
export GEMINI_API_KEY="your_key_here"
export POSTGRES_PASSWORD="your_password_here"
export NOTION_TOKEN="your_token_here"

# Never commit .env files
echo ".env" >> .gitignore
```

### 2. Production Deployment
- Use secret management systems
- Implement credential rotation
- Monitor access logs
- Set up alerts for unusual activity

### 3. Testing
- Use separate test credentials
- Implement data masking for test profiles
- Regular security testing
- Code review for security issues

## 📊 Monitoring & Auditing

### Security Monitoring
- Monitor webhook access patterns
- Track API usage and anomalies
- Log authentication attempts
- Set up alerts for failed connections

### Regular Security Tasks
- [ ] Monthly credential rotation
- [ ] Quarterly security review
- [ ] Annual penetration testing
- [ ] Regular backup testing

## 🆘 Security Incident Response

### If Credentials Are Compromised:
1. **Immediate**: Revoke compromised credentials
2. **Within 1 hour**: Generate new credentials
3. **Within 4 hours**: Update all systems
4. **Within 24 hours**: Review access logs
5. **Within 1 week**: Conduct security review

### Emergency Contacts
- Database Administrator: [Contact Info]
- API Provider Support: [Contact Info]
- Security Team: [Contact Info]

## ✅ Security Checklist

### Initial Setup
- [ ] All credentials created with strong authentication
- [ ] Template workflow imported (not actual export)
- [ ] All placeholder values replaced
- [ ] Database connections encrypted
- [ ] API rate limits configured

### Regular Maintenance
- [ ] Credentials rotated quarterly
- [ ] Access logs reviewed monthly
- [ ] Security patches applied promptly
- [ ] Backup procedures tested
- [ ] Monitoring alerts functioning

### Before Public Release
- [ ] No sensitive data in repository
- [ ] Template files sanitized
- [ ] Documentation reviewed for security
- [ ] Code reviewed for hardcoded secrets
- [ ] Test environment secured

## 📚 Additional Resources

- [OWASP API Security Top 10](https://owasp.org/www-project-api-security/)
- [n8n Security Best Practices](https://docs.n8n.io/hosting/security/)
- [Database Security Guidelines](https://cheatsheetseries.owasp.org/cheatsheets/Database_Security_Cheat_Sheet.html)
- [API Key Management Best Practices](https://cloud.google.com/docs/authentication/api-keys)